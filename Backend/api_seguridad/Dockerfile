FROM amazoncorretto:17 AS build

WORKDIR /project

VOLUME /tmp
ARG JAR_FILE=build/libs/*.jar
COPY ${JAR_FILE} app.jar

EXPOSE 8000

ENV JAVA_OPTS=" -XX:+UseContainerSupport -XX:MaxRAMPercentage=70 -Djava.security.egd=file:/dev/./urandom"

ENV SPRING_DATASOURCE_DRIVER_CLASS_NAME=#{SPRING_DATASOURCE_DRIVER_CLASS_NAME}#
ENV SPRING_DATASOURCE_URL=#{SPRING_DATASOURCE_URL}#
ENV SPRING_DATASOURCE_USERNAME=#{SPRING_DATASOURCE_USERNAME}#
ENV SPRING_DATASOURCE_PASSWORD=#{SPRING_DATASOURCE_PASSWORD}#

ENTRYPOINT [ "sh", "-c", "java $JAVA_OPTS  -jar app.jar" ]
